---
title: "Лекция №1"
author: "Георгий Мороз, Ольга Ляшевская, Илья Щуров, НИУ ВШЭ"
date: "11 ноября 2015"
output:
  knitrBootstrap::bootstrap_document:
    theme.chooser: TRUE
    highlight.chooser: TRUE
    highlight: Xcode
  toc: true
  toc_depth: 4
---

# Лекция №1: Какими бывают данные и с чем их едят

*Георгий Мороз, Ольга Ляшевская, Илья Щуров, НИУ ВШЭ*

*Курс «Анализ лингвистических данных: квантитативные методы и визуализация», 2015-16 учебный год: [все материалы курса](http://hsequantling.wikispaces.com/), [исходные коды](https://github.com/ischurov/hsequantling).*


Процесс исследования в современных науках устроен примерно одинаково. Сначала у нас есть некоторая гипотеза о том, как устроен окружающий мир. Чтобы гипотеза была научной, она должна быть опровержима ([«фальсифицируема»](https://ru.wikipedia.org/wiki/%D0%A4%D0%B0%D0%BB%D1%8C%D1%81%D0%B8%D1%84%D0%B8%D1%86%D0%B8%D1%80%D1%83%D0%B5%D0%BC%D0%BE%D1%81%D1%82%D1%8C)), то есть мы должны иметь возможность представить себе такое наблюдение об окружающем мире, которое бы противоречило этой гипотезе. После того, как гипотеза сформулирована, мы пытаемся понять, насколько она согласуется с тем, что на самом деле существует в реальности. Для этого мы делаем какие-то эксперименты или проводим какие-то другие наблюдения и записываем их результаты в виде набора *данных*. После этого мы используем математические методы, чтобы понять, в какой мере данные согласуются с гипотезой. Дальше мы можем сделать какой-то вывод о гипотезе: например, гипотеза хорошо согласуется с данными, или наоборот, данные противоречат гипотезе и её, видимо, следует отвергнуть, или же мы можем сделать вывод, что данных недостаточно, чтобы сказать что-то определённое.

О проверке гипотез мы поговорим отдельно, а сегодня речь пойдёт о том, какими бывают данные в лингвистике.

## Примеры лингвистических данных

- Пол информанта
- Родной язык информанта
- Образование информанта
- Год рождения информанта
- Длительность звука
- Частота звука
- Количество вхождений словоформы в некотором тексте

## Типы данных
### Номинальная шкала
Эти примеры показывают, что данные могут иметь разную природу. Пол информанта может принимать одно из двух возможных значений — «мужской» или «женский». При этом среди этих значений нет никакого порядка (ни про одно из них нельзя сказать, что оно больше, чем другое) и нет никаких операций. Аналогичная ситуация с родным языком информанта — он может принимать только одно из нескольких значений (например, английский, клингонский и суахили) и никакого отношения между этими значениями нет. Говорят, что это данные в *номинальной шкале* или что это *категориальные данные* или что это *факторы*. Последний термин активно используется в R, там есть специальный тип данных `factor`.

### Порядковая шкала
Образование информанта, на первый взгляд, кажется похожим: оно тоже может принимать одно из конечного множество значений (например: «начальное», «среднее», «высшее», «учёная степень»). Однако здесь между различными значениями есть связь: они упорядочены. Мы знаем, что среднее образование «больше», чем начальное, а высшее «больше», чем среднее. Любые два значения можно сравнить и выяснить, какое из них больше. В этом случае говорят, что данные относятся к *порядковой (или ранговой) шкале*. Однако, кроме порядка здесь нет никаких других отношений.

### Интервальная шкала
Год рождения информанта относится к другому типу: зная год рождения, можно не только установить, кто из информантов старше кого (то есть ввести порядок), но и узнать, *на сколько именно лет* старше. Например, если у нас есть три информанта, первый 1980 года рождения, второй 1984, а третий 1992, то мы не просто знаем, что третий самый младший, но и значем, что разница в возрасте между третьим и вторым равна 8 лет, что вдвое больше, чем разница в возрасте между вторым и первым. Говорят, что эти данные относятся к *интервальной* шкале (или *шкале разностей*). С такими данными можно производить арифметические операции сложения и вычитания. А вот умножать их нельзя — если год рождения увеличить вдвое, получится довольно бессмысленная вещь.

### Абсолютная шкала
Наконец, длительность звука, его частота или количество вхождений словоформы относятся к данным на *абсолютной* шкале (или *шкале отношений*). Можно сказать, что значит «длительность звука у одного информанта вдвое больше, чем у другого», это корректно определенная величина.

Подробнее о шкалах написано в [Википедии](https://ru.wikipedia.org/wiki/%D0%A8%D0%BA%D0%B0%D0%BB%D0%B0).

### Дискретные и непрерывные величины
Есть ещё одно свойство данных, задаваемых числами: они могут быть *непрерывными* (например, длительность звука в миллисекундах), а могут быть *дискретными* (например, число вхождений словоформы или длина слова в слогах). Дискретные данные обычно задаются целыми числами, а непрерывные — вещественными. Некоторые статистические инструменты осмысленно работают только для дискретных величин, а некоторые, наоборот, только для непрерывных. 

### Представление данных
При компьютерной обработке данные могут кодироваться по-разному. Представим себе несколько студенческих групп, имеющих номера 101, 102 и 103. Допустим, мы исследуем студентов и про каждого студента можем написать, к какой группе он относится. Если эти три группы ничем друг от друга не отличаются (студентов распределяли по ним случайным образом), то номер группы будет категориальной переменной. Хотя номера и являются числами, но их числовые значения не интересны и не имеют никакого смысла, они не устанавливают никакого порядка, мы могли бы перенумеровать эти группы или обозначать их буквами A, B, C вместо чисел.

Другое дело, если мы знаем, что студенты распределялись по группам в соответствии с результатами, например, вводного теста по английскому языку, и в группе 103 находятся самые сильные студенты, а в группе 101 самые слабые. В этом случае номера 101, 102, 103 задают порядок, то есть мы имеем дело с порядковой шкалой. Однако, например, операции между этими числами не будут иметь смысла: нет оснований говорить, что разница в знании языка между группами 103 и 101 «в два раза больше», чем разница между группами 103 и 102.

Зачастую нам надо явно объяснять компьютеру, какой тип данных подразумевается в каком контексте. Например, чтобы объявить переменную категориальной, в R нужно использовать функцию `as.factor()`.

## Датафреймы
Результаты экспериментов или наблюдений обычно записываются в таблички, называемые датафреймами (data frames). Как именно устроена эта табличка, зависит от вашего эксперимента и вообще дизайна исследования. Например, можно представить себе табличку, в которой для каждого информанта написан его пол, год рождения, образование и ещё какие-то данные, которые относятся к этому информанту — скажем, мы заставили его читать текст и меряем, сколько времени у него это заняло. Каждая строка этой таблицы называется *наблюдением* (*observation*), а каждый столбец — *переменной* (*variable*).

```{r, bootstrap.show.code=F}
library(knitr)
df <- data.frame(
  informant_id=1:7, 
  sex = c('male','male','female','male','female','male','male'),
  year=c(1982, 1986, 1990, 1976, 1945, 1990, 1976), 
  education = factor(
    c('higher','degree',
      'elementary','secondary',
      'elementary','elementary',
      'higher'), 
    levels=c('elementary','secondary','higher','degree'), 
    ordered=T
    ), 
  duration = c(11.3, 15.2, 12.2, 15.4, 13.2, 14.5, 10.2))
kable(df)
attach(df)
```

## Выборки и их свойства
Одна из целей нашего курса — научиться «смотреть» на данные, извлекать из них какую-то информацию. Нас чаще всего интересуют разнообразные связи между разными переменными, но для начала рассмотрим одну какую-то переменную и все её значения, записанные в датафрейм. Получится *выборка*.

### Распределение и мода
Начнём с переменной `sex`. Она категориальная и если смотреть только на неё, то мы получим просто вот такую последовательность: `r df$sex`. Самое лучшее, что можно понять про это последовательность, это посчитать, сколько раз там встречается каждое из значений (эти числа называются *(абсолютными) частотами*, а вся табличка задаёт *распределение* выборки):

```{r}
summary(sex)
```
Можно посчитать, какое значение встречается чаще всего (в данном случае это `male`) — оно называется *модой* выборки.

### Медиана
Для переменной `education` ситуация уже более интересная. Допустим, мы хотим задаться вопросом «какое образование «в среднем» имеют наши респонденты»? С одной стороны, можно снова посчитать частоты и найти моду выборки.

```{r}
summary(education)
```
Из этой таблицы видно, что самым распространённым в нашей выборке является начальное (`elementary`) образование. Однако, можно подойти к вопросу о среднем другим способом. Воспользуемся тем, что переменная `education` относится к порядковой шкале и упорядочим все элементы нашей выборки в соответствии с этим порядком. Получится вот такой ряд:

` `r sort(education)` `

Если выбрать теперь средний элемент этого ряда (четвертый), то он будет в некотором смысле «средним» для всей выборки. Это *медиана* выборки. В данном случае медиана имеет значение `secondary`. (Если бы число элементов было чётным, мы могли бы столкнуться с трудностями при выборе среднего элемента, но не будем углубляться в детали.) Заметим, что медиана не обязана совпадать с модой.

### Выборочное среднее
Обратимся теперь к переменной `year`. Она относится к интервальной шкале, состоит из чисел, с которыми можно выполнять операции сложения и вычитания. Для этой переменной можно найти *выборочное среднее* — то есть просто среднее арифметическое.
```{r}
mean(year)
```
Аналогично можно было бы найти выборочное среднее переменной `duration`.
```{r}
mean(duration)
```
Медианы от выборок, соответствующих этим переменным, тоже можно найти и они, вообще говоря, не обязаны совпадать со средними:
```{r}
median(year)
```
```{r}
median(duration)
```
Медиана и среднее — это разные способы ответить на вопрос «чему „в среднем” равно значение переменной». Они по-разному зависят от выборки. Например, если в выборку добавить один элемент, сильно отличающийся от других, то это может достаточно сильно повлиять на значение среднего, но практически не повлияет на медиану. 

### Дисперсия и стандартное отклонение
Знание выборочного среднего — полезная информация о выборке. Например, мы знаем, что в некоторой группе средний возраст информантов — 18 лет; это означает, что мы имеем дело скорее с молодёжью, чем с людьми зрелого возраста. Однако даже для получения совсем примерного представления о выборке среднего обычно недостаточно. Рассмотрим две таблицы с данными об информантах:
```{r, bootstrap.show.code=F}
df1 <- data.frame(informant_id = c(1,2,3,4), age = c(18, 40, 4, 10))
kable(df1)
df2 <- data.frame(informant_id = c(5,6,7,8,9), age=c(18,19,19,17,17))
kable(df2)
```

Средний возраст информантов в обоих исследованиях одинаковый (18 лет), но понятно, что это совсем разные исследования: в первом в выборку попало два ребёнка и один 40-летний человек, а вторая явно сконцентрирована на исследовании молодёжи.

Чтобы различать эти две ситуации используют такие показатели выборки, как *выборочную дисперсию* (*variance*, `var`) и *стандартное отклонение* (*standart deviation*, `sd`). Они показывают, насколько сильно элементы выборки отклоняются от своего среднего значения.

Выборочная дисперсия вычисляется так: нужно из каждого элемента выборки вычесть среднее, возвести получающиеся числа в квадрат, сложить и поделить на число элементов выборки минус 1. (Строго говоря, это называется *исправленной* выборочной дисперсией из-за этого «минус 1».) Например, для первого из двух приведенных исследований мы получим:
$$
\frac{(18-18)^2+(40-18)^2+(4-18)^2+(10-18)^2}{4-1}=`r var(df1$age)`
$$
А для второго:
$$
\frac{(18-18)^2+(19-18)^2+(19-18)^2+(17-18)^2+(17-18)^2}{5-1}=`r var(df2$age)`
$$
Дисперсия второй выборки гораздо меньше дисперсии первой.

*Стандартное отклонение* (оно ещё иногда называется *среднеквадратичным отклонением*) — это квадратный корень из исправленной выборочной дисперсии. То есть стандартное отклонение первой выборки составит $`r sd(df1$age)`$, а второй $`r sd(df2$age)`$. Стандартное отклонение измеряется в тех же единицах, что и сама переменная. 
